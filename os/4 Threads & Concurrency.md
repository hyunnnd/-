## ğŸ“˜ Overview

- **í”„ë¡œì„¸ìŠ¤(Process)**: ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨
- **ìŠ¤ë ˆë“œ(Thread)**: í”„ë¡œê·¸ë¨ì´ ìì‹ ì„ ì—¬ëŸ¬ ì‘ì—…ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë‹¨ìœ„
- ìŠ¤ë ˆë“œëŠ” í”„ë¡œì„¸ìŠ¤ë³´ë‹¤ ì‘ì€ ë‹¨ìœ„
- í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ë‚´ ìŠ¤ë ˆë“œë“¤ì€ ìì›ì„ ê³µìœ 
- ìŠ¤ë ˆë“œëŠ” ë‹¤ìŒ ì •ë³´ë¥¼ ê°€ì§:
  - Thread ID, Program Counter, Register Set, Stack ë“±


![[Pasted image 20250513182928.png]]

## ğŸ“˜ Address Spaces

- ê° ìŠ¤ë ˆë“œëŠ” **ìê¸°ë§Œì˜ ìŠ¤íƒ(Stack)**ì„ ê°€ì§
- ê·¸ ì™¸ ìì›(ì½”ë“œ, í™ ë“±)ì€ **ê³µìœ ë¨**

### ğŸ”¹ ë©”ëª¨ë¦¬ êµ¬ì¡°:
- **ì½”ë“œ(Code)**: í”„ë¡œê·¸ë¨ ëª…ë ¹ì–´
- **í™(Heap)**: ë™ì  í• ë‹¹ ë°ì´í„° (malloc ë“±)
- **ìŠ¤íƒ(Stack)**: ì§€ì—­ ë³€ìˆ˜, í•¨ìˆ˜ í˜¸ì¶œ ì¸ì ë“±
- ![[Pasted image 20250513182957.png]]

> ë‹¨ì¼ ìŠ¤ë ˆë“œ vs. ë‘ ê°œì˜ ìŠ¤ë ˆë“œê°€ ìˆëŠ” ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë¹„êµí•¨



## ğŸ“˜ Thread Control Block

- **TCB (Thread Control Block)**: ìŠ¤ë ˆë“œ ê´€ë¦¬ì— í•„ìš”í•œ ì •ë³´ë¥¼ ë‹´ì€ ì»¤ë„ì˜ ìë£Œêµ¬ì¡°
- Linuxì—ì„œëŠ” `thread_struct`

### ğŸ”¹ í¬í•¨ ì •ë³´:
- Thread ID
- í˜„ì¬ ìƒíƒœ (running, ready, waiting ë“±)
- ìŠ¤íƒ í¬ì¸í„°, í”„ë¡œê·¸ë¨ ì¹´ìš´í„°
- ë ˆì§€ìŠ¤í„° ê°’
- í•´ë‹¹ ìŠ¤ë ˆë“œê°€ ì†í•œ **PCB (Process Control Block)**ì˜ í¬ì¸í„°


## ğŸ“˜ Why Use Threads?

- **í”„ë¡œì„¸ìŠ¤ ìƒì„±ì€ ì‹œê°„ê³¼ ìì› ì¸¡ë©´ì—ì„œ ë¹„ìš©ì´ í¼**
- ì˜ˆ: ì›¹ ì„œë²„ëŠ” ìˆ˜ì²œ ê°œì˜ ìš”ì²­ì„ ì²˜ë¦¬í•´ì•¼ í•˜ë¯€ë¡œ, í”„ë¡œì„¸ìŠ¤ë³´ë‹¤ ìŠ¤ë ˆë“œê°€ íš¨ìœ¨ì 
![[Pasted image 20250513183245.png]]
> ë³‘ë ¬ ì²˜ë¦¬ì™€ íš¨ìœ¨ì  ìì› í™œìš©ì„ ìœ„í•œ ìˆ˜ë‹¨ìœ¼ë¡œ ìŠ¤ë ˆë“œ ì‚¬ìš©

- **ë³‘ë ¬ì„±(Parallelism)** í™•ë³´ ê°€ëŠ¥:
  - ë‹¨ì¼ ìŠ¤ë ˆë“œ í”„ë¡œê·¸ë¨ì€ ì§ê´€ì ì´ì§€ë§Œ ëŠë¦¼
  - ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ë¨ì€ ì—¬ëŸ¬ CPUë¥¼ í™œìš©í•˜ì—¬ ì†ë„ í–¥ìƒ

- **I/O ì§€ì—°ìœ¼ë¡œ ì¸í•œ ë¸”ë¡œí‚¹ ë°©ì§€**:
  - ìŠ¤ë ˆë“œëŠ” I/O ì‘ì—…ê³¼ ë‹¤ë¥¸ ì—°ì‚°ì„ **ë™ì‹œì— ì²˜ë¦¬** ê°€ëŠ¥
  - ì´ëŠ” í”„ë¡œì„¸ìŠ¤ ê¸°ë°˜ ë©€í‹°í”„ë¡œê·¸ë˜ë°ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, **í”„ë¡œì„¸ìŠ¤ ê°„ë³´ë‹¤ ë¹„ìš© ì ìŒ**
### ğŸ”¹ ìŠ¤ë ˆë“œ ì‚¬ìš©ì˜ ì¥ì :
- **ì‘ë‹µì„± (Responsiveness)**: ì¼ë¶€ê°€ ë¸”ë¡ë¼ë„ ë‚˜ë¨¸ì§€ ì‘ì—…ì€ ê³„ì† ìˆ˜í–‰ ê°€ëŠ¥ â†’ UIì— ì¤‘ìš”
- **ìì› ê³µìœ  (Resource Sharing)**: ë™ì¼ í”„ë¡œì„¸ìŠ¤ ë‚´ ìì› ê³µìœ ê°€ ì‰¬ì›€
- **ê²½ì œì„± (Economy)**: í”„ë¡œì„¸ìŠ¤ë³´ë‹¤ ìƒì„±Â·ì „í™˜ ë¹„ìš©ì´ ì €ë ´
- **í™•ì¥ì„± (Scalability)**: ë‹¤ì¤‘ í”„ë¡œì„¸ì„œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í™œìš© ê°€ëŠ¥

## ğŸ“˜ Parallelism and Concurrency

### ğŸ”¹ ë©€í‹°ì½”ì–´/ë©€í‹°í”„ë¡œì„¸ì„œ í™˜ê²½ì—ì„œì˜ ë„ì „ ê³¼ì œ:
- ì‘ì—… ë¶„í• 
- ë¶€í•˜ ê· í˜•
- ë°ì´í„° ë¶„í• 
- ë°ì´í„° ì˜ì¡´ì„±
- í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…

### ğŸ”¹ ê°œë… êµ¬ë¶„:
- **Parallelism**: ì—¬ëŸ¬ ì‘ì—…ì„ **ì‹¤ì œë¡œ ë™ì‹œì— ìˆ˜í–‰**
- **Concurrency**: ì—¬ëŸ¬ ì‘ì—…ì´ **ë™ì‹œì— ì§„í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ë„ë¡ êµ¬ì„±**
  - ë‹¨ì¼ ì½”ì–´ì—ì„œë„ **ìŠ¤ì¼€ì¤„ë§**ì„ í†µí•´ ê°€ëŠ¥


## ğŸ“˜ Concurrency vs. Parallelism

- **Concurrency**: ë‹¨ì¼ ì½”ì–´ì—ì„œë„ ì‹œê°„ ë¶„í• ë¡œ ì—¬ëŸ¬ ì‘ì—…ì´ **ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ë“¯ì´ ë³´ì„**
- **Parallelism**: ë©€í‹°ì½”ì–´ ì‹œìŠ¤í…œì—ì„œ **ë¬¼ë¦¬ì ìœ¼ë¡œ ë™ì‹œì— ì‹¤í–‰**
![[Pasted image 20250513185654.png]]

> â¬… ìŠ¬ë¼ì´ë“œì—ëŠ” ë‘ ê°€ì§€ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë¹„êµí•œ ë„ì‹ í¬í•¨


## ğŸ“˜ Types of Parallelism

- **ë°ì´í„° ë³‘ë ¬ì„± (Data Parallelism)**:
  - ë™ì¼í•œ ì‘ì—…ì„ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° ë¶€ë¶„ì— ëŒ€í•´ ìˆ˜í–‰
  - ex) ë²¡í„° ìš”ì†Œë¥¼ ë³‘ë ¬ë¡œ ì²˜ë¦¬

- **ì‘ì—… ë³‘ë ¬ì„± (Task Parallelism)**:
  - ê° ìŠ¤ë ˆë“œê°€ **ì„œë¡œ ë‹¤ë¥¸ ì‘ì—…**ì„ ìˆ˜í–‰
  - ex) í•œ ìŠ¤ë ˆë“œëŠ” ë Œë”ë§, ë‹¤ë¥¸ ìŠ¤ë ˆë“œëŠ” ì…ì¶œë ¥ ì²˜ë¦¬
![[Pasted image 20250513185728.png]]


## ğŸ“˜ Amdahlâ€™s Law

- ë³‘ë ¬ ì²˜ë¦¬ì—ì„œ ì„±ëŠ¥ í–¥ìƒ í•œê³„ë¥¼ ì œì‹œí•˜ëŠ” ë²•ì¹™

### ğŸ”¹ ì‹:
![[Pasted image 20250513185816.png]]
- S: í”„ë¡œê·¸ë¨ì˜ ì§ë ¬ ë¶€ë¶„ ë¹„ìœ¨
- N: í”„ë¡œì„¸ì„œ ìˆ˜

### ğŸ”¹ ì˜ˆ:
- í”„ë¡œê·¸ë¨ì˜ 75%ê°€ ë³‘ë ¬ ê°€ëŠ¥í•  ë•Œ, 2ê°œ ì½”ì–´ ì‚¬ìš© â†’ **1.6ë°° ì†ë„ í–¥ìƒ**
- Nì´ ë¬´í•œëŒ€ë¡œ ê°€ë„, ì†ë„ í–¥ìƒ í•œê³„ëŠ” `1/S`

> ì§ë ¬ êµ¬ê°„ì´ í´ìˆ˜ë¡ ë³‘ë ¬í™”ì˜ ì´ì ì´ ì œí•œë¨


## ğŸ“˜ User Threads and Kernel Threads

### ğŸ”¹ User Thread (ì‚¬ìš©ì ìŠ¤ë ˆë“œ)
- ì‚¬ìš©ì ê³µê°„ì˜ ìŠ¤ë ˆë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì˜í•´ ê´€ë¦¬ë¨
- **ì‹œìŠ¤í…œ ì½œ ì—†ì´ ìƒì„±** ê°€ëŠ¥ (ex. `pthread_create`)
- ì»¤ë„ì€ ì¡´ì¬ë¥¼ ëª¨ë¦„ â†’ **ìŠ¤ì¼€ì¤„ë§ ë¹ ë¦„**
- ì „í™˜ ë¹„ìš©ì´ ì‘ì§€ë§Œ, **í•œ ìŠ¤ë ˆë“œì˜ ë¸”ë¡ì´ ì „ì²´ ìŠ¤ë ˆë“œ ë¸”ë¡ ìœ ë°œ ê°€ëŠ¥**

### ğŸ”¹ Kernel Thread (ì»¤ë„ ìŠ¤ë ˆë“œ)
- ì»¤ë„ì— ì˜í•´ ìƒì„± ë° ê´€ë¦¬
- ì»¤ë„ ìˆ˜ì¤€ì—ì„œ ì§ì ‘ ìŠ¤ì¼€ì¤„ë§
- **ì‚¬ìš©ì ìŠ¤ë ˆë“œë³´ë‹¤ ì „í™˜ ë¹„ìš©ì´ í¼**, í•˜ì§€ë§Œ ë³‘ë ¬ ì‹¤í–‰ ê°€ëŠ¥

> ëŒ€ë¶€ë¶„ì˜ OSëŠ” ì»¤ë„ ìŠ¤ë ˆë“œ ê¸°ë°˜ ë©€í‹°ìŠ¤ë ˆë”© ì§€ì›


## ğŸ“˜ Kernel Thread

- ìš´ì˜ì²´ì œ ì»¤ë„ ìì²´ë„ ë³´í†µ **ë©€í‹°ìŠ¤ë ˆë“œ êµ¬ì¡°**
- ì»¤ë„ ìŠ¤ë ˆë“œëŠ” ë‹¤ì–‘í•œ ì‘ì—…ì„ ë³‘ë ¬ë¡œ ìˆ˜í–‰
  - ex) ë””ë°”ì´ìŠ¤ ê´€ë¦¬, ë©”ëª¨ë¦¬ ê´€ë¦¬, ì¸í„°ëŸ½íŠ¸ ì²˜ë¦¬ ë“±

> ì»¤ë„ ìŠ¤ë ˆë“œëŠ” ì‹œìŠ¤í…œ ì „ë°˜ì˜ ë³‘ë ¬ì„±ê³¼ ì‘ë‹µì„±ì„ ë†’ì´ëŠ” ë° í•µì‹¬ ì—­í•  ìˆ˜í–‰


## ğŸ“˜ Multithreading Models ê°œìš”

- **ì£¼ìš” ì´ìŠˆ**: ì‚¬ìš©ì ìŠ¤ë ˆë“œ â†” ì»¤ë„ ìŠ¤ë ˆë“œ ê°„ **ë§¤í•‘ ë°©ì‹**

### ğŸ”¹ ì„¸ ê°€ì§€ ëª¨ë¸:
1. **Many-to-One**
2. **One-to-One**
3. **Many-to-Many (ë˜ëŠ” Two-Level)**

> ê° ëª¨ë¸ì€ ì‚¬ìš©ì ìŠ¤ë ˆë“œì™€ ì»¤ë„ ìŠ¤ë ˆë“œì˜ ì—°ê²° êµ¬ì¡° ë° íš¨ìœ¨ì„±ì—ì„œ ì°¨ì´ ë°œìƒ


## ğŸ“˜ Many-to-One

- ì—¬ëŸ¬ **ì‚¬ìš©ì ìŠ¤ë ˆë“œ**ê°€ í•˜ë‚˜ì˜ **ì»¤ë„ ìŠ¤ë ˆë“œ**ì— ë§¤í•‘ë¨
- í•œ ìŠ¤ë ˆë“œê°€ ë¸”ë¡ë˜ë©´ â†’ **ì „ì²´ ì‚¬ìš©ì ìŠ¤ë ˆë“œ ë¸”ë¡**
- **ë©€í‹°ì½”ì–´ í™˜ê²½ì—ì„œ ë³‘ë ¬ ì‹¤í–‰ ë¶ˆê°€**

### ğŸ”¹ ë‹¨ì :
- ë³‘ë ¬ì„± ì—†ìŒ
- ì‹œìŠ¤í…œ ì „ì²´ê°€ í•œ ìŠ¤ë ˆë“œë¡œ ì¸ì‹ë¨

### ğŸ”¹ ì‚¬ìš© ì˜ˆ:
- Solaris Green Threads (ê³¼ê±°)
- ì´ˆê¸° Java ìŠ¤ë ˆë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬

## ğŸ“˜ One-to-One

- ê° ì‚¬ìš©ì ìŠ¤ë ˆë“œê°€ **í•˜ë‚˜ì˜ ì»¤ë„ ìŠ¤ë ˆë“œì— ë§¤í•‘**
- **ë³‘ë ¬ì„± í™•ë³´ ê°€ëŠ¥**
- ì‚¬ìš©ì ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ ë•Œ ì»¤ë„ ìŠ¤ë ˆë“œë„ ìƒì„±ë¨ â†’ **ì˜¤ë²„í—¤ë“œ ì¡´ì¬**

### ğŸ”¹ ì¥ì :
- ê° ìŠ¤ë ˆë“œê°€ ë…ë¦½ì ìœ¼ë¡œ ìŠ¤ì¼€ì¤„ë§ ê°€ëŠ¥
- ë³‘ë ¬ì„± ì§€ì›

### ğŸ”¹ ë‹¨ì :
- ì»¤ë„ ë¦¬ì†ŒìŠ¤ ì†Œëª¨ â†‘ â†’ **ìŠ¤ë ˆë“œ ìˆ˜ ì œí•œ ê°€ëŠ¥ì„±**

### ğŸ”¹ ì‚¬ìš© ì˜ˆ:
- Windows, Linux

## ğŸ“˜ Many-to-Many

- ì—¬ëŸ¬ ì‚¬ìš©ì ìŠ¤ë ˆë“œ â†” ì—¬ëŸ¬ ì»¤ë„ ìŠ¤ë ˆë“œë¡œ **ìœ ì—°í•˜ê²Œ ë§¤í•‘ ê°€ëŠ¥**
- OSê°€ ì»¤ë„ ìŠ¤ë ˆë“œë¥¼ ì ì ˆíˆ ìƒì„±/ê´€ë¦¬

### ğŸ”¹ ì¥ì :
- ë³‘ë ¬ì„± í™•ë³´ + ì‚¬ìš©ì ìŠ¤ë ˆë“œ ìˆ˜ ì œí•œ ì—†ìŒ
- íš¨ìœ¨ì  ìì› ì‚¬ìš© ê°€ëŠ¥

### ğŸ”¹ ì˜ˆì‹œ:
- Windowsì˜ ThreadFiber íŒ¨í‚¤ì§€
- ê·¸ ì™¸ì—ëŠ” ë“œë¬¼ê²Œ ì‚¬ìš©

> ë‘ ê°€ì§€ ë°©ì‹ì˜ ì ˆì¶©í˜• â†’ **Two-Level Model**ë¡œë„ ë¶ˆë¦¼



## ğŸ“˜ Thread Libraries

- **ìŠ¤ë ˆë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬**ëŠ” ìŠ¤ë ˆë“œ ìƒì„±ì„ ìœ„í•œ **APIë¥¼ ì œê³µ**

### ğŸ”¹ êµ¬í˜„ ë°©ì‹:
1. **ì‚¬ìš©ì ìˆ˜ì¤€(User-level)**:
   - ì»¤ë„ ê°œì… ì—†ì´ ì‚¬ìš©ì ê³µê°„ì—ì„œë§Œ ê´€ë¦¬
   - ì „í™˜ ë¹ ë¦„, í•˜ì§€ë§Œ ì»¤ë„ì€ ìŠ¤ë ˆë“œ ì¡´ì¬ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•¨

2. **ì»¤ë„ ìˆ˜ì¤€(Kernel-level)**:
   - ìŠ¤ë ˆë“œ ìƒì„±/ê´€ë¦¬ ëª¨ë‘ ì»¤ë„ì´ ìˆ˜í–‰
   - ë³‘ë ¬ ì‹¤í–‰ ê°€ëŠ¥, ì‹œìŠ¤í…œ í˜¸ì¶œ í•„ìš”

> ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í”„ë¡œê·¸ë˜ë¨¸ê°€ ì§ì ‘ ìŠ¤ë ˆë“œ ìƒì„±Â·ê´€ë¦¬í•˜ì§€ ì•Šê³ ë„ ë©€í‹°ìŠ¤ë ˆë”© êµ¬í˜„ ê°€ëŠ¥



## ğŸ“˜ Pthreads

- **Pthreads (POSIX Threads)**: POSIX í‘œì¤€ (IEEE 1003.1c)ì— ë”°ë¥¸ ìŠ¤ë ˆë“œ API
- UNIX ê³„ì—´ ìš´ì˜ì²´ì œ(Solaris, Linux, macOS ë“±)ì—ì„œ ë„ë¦¬ ì‚¬ìš©

### ğŸ”¹ íŠ¹ì§•:
- PthreadsëŠ” **ëª…ì„¸(specification)**ì´ë©°, êµ¬í˜„ì€ ì‹œìŠ¤í…œì— ë”°ë¼ ë‹¤ë¦„ not implementation
- ì‚¬ìš©ì ìˆ˜ì¤€ ë˜ëŠ” ì»¤ë„ ìˆ˜ì¤€ ëª¨ë‘ êµ¬í˜„ ê°€ëŠ¥

### ğŸ”¹ ì œê³µ ê¸°ëŠ¥:
- ìŠ¤ë ˆë“œ ìƒì„± (`pthread_create`)
- ë™ê¸°í™” (`pthread_join`, mutex ë“±)
- ì¢…ë£Œ, ì·¨ì†Œ ë“± ë‹¤ì–‘í•œ API

> POSIX í‘œì¤€ì— ë”°ë¼ ë‹¤ì–‘í•œ ì‹œìŠ¤í…œì—ì„œ **ì´ì‹ì„± ë†’ì€ ë©€í‹°ìŠ¤ë ˆë”©** êµ¬í˜„ ê°€ëŠ¥



## ğŸ“˜ pthread_create

- **pthread_create()**: ìƒˆë¡œìš´ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ 
```c
#include <pthread.h>
int pthread_create(pthread_t *thread, const pthread_attr_t *attr,
                   void *(*start_routine) (void *), void *arg);
                   
```
### ğŸ”¹ ë§¤ê°œë³€ìˆ˜:

- `thread`: ìƒì„±ëœ ìŠ¤ë ˆë“œì˜ IDë¥¼ ì €ì¥í•  ë³€ìˆ˜
- `attr`: ìŠ¤ë ˆë“œ ì†ì„± ì„¤ì • (NULL ì‹œ ê¸°ë³¸ ì†ì„± ì‚¬ìš©)
- `start_routine`: ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  í•¨ìˆ˜
- `arg`: ìŠ¤ë ˆë“œ í•¨ìˆ˜ë¡œ ì „ë‹¬í•  ì¸ì

### ğŸ”¹ ë°˜í™˜ê°’:

- ì„±ê³µ: 0
- ì‹¤íŒ¨: ì˜¤ë¥˜ ì½”ë“œ

> ìŠ¤ë ˆë“œëŠ” **start_routine í•¨ìˆ˜ì—ì„œ ì‹œì‘í•˜ì—¬ ì¢…ë£Œ**ë¨


## ğŸ“˜ pthread_join 

- **pthread_join()**: íŠ¹ì • ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ í˜¸ì¶œí•œ ìŠ¤ë ˆë“œë¥¼ **ëŒ€ê¸° ìƒíƒœë¡œ ë§Œë“¦** , ì´ë¯¸  ì¢…ë£Œë¬ë‹¤ë©´ ì¦‰ì‹œ ì‹¤í–‰(ë§ëŠ”ì§€ ì²´í¬í•´ë³´ê¸°)
```c
#include <pthread.h>
int pthread_join(pthread_t thread, void **retval);
```

### ğŸ”¹ ë§¤ê°œë³€ìˆ˜:

- `thread`: ëŒ€ê¸°í•  ìŠ¤ë ˆë“œì˜ ID
- `retval`: ì¢…ë£Œëœ ìŠ¤ë ˆë“œê°€ ë°˜í™˜í•œ ê°’ (í•„ìš” ì—†ìœ¼ë©´ NULL)

### ğŸ”¹ íŠ¹ì§•:

- **ì°¨ë‹¨ í•¨ìˆ˜**: ëŒ€ìƒ ìŠ¤ë ˆë“œê°€ ëë‚  ë•Œê¹Œì§€ í˜¸ì¶œì ìŠ¤ë ˆë“œëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
- ë¶€ëª¨ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ **ìì‹ ìŠ¤ë ˆë“œë„ ê°•ì œ ì¢…ë£Œë¨**

> `pthread_join`ì€ ìŠ¤ë ˆë“œ ê°„ì˜ **ì¢…ì†ì„± ì œì–´** ë° **ìì› íšŒìˆ˜**ì— í•„ìˆ˜ì 



## ğŸ“˜ Compiling and Running

### ğŸ”¹ ì»´íŒŒì¼ ë°©ë²•:
- ë°˜ë“œì‹œ `pthread.h` í—¤ë” í¬í•¨
- **`-pthread` ì˜µì…˜ ì¶”ê°€ í•„ìš”**

```bash
$ gcc -o main main.c -Wall -pthread
```
>ìµœì‹  gccëŠ” `-pthread` ì˜µì…˜ì„ ìë™ìœ¼ë¡œ í¬í•¨í•˜ê¸°ë„ í•¨



## ğŸ“˜ Example â€“ Thread Creation

```c
#include <stdio.h>
#include <pthread.h>

void *mythread(void *arg) {
    printf("%s\n", (char *) arg);
    return NULL;
}

int main() {
    pthread_t p1, p2;

    printf("main: begin\n");
    pthread_create(&p1, NULL, mythread, "A");
    pthread_create(&p2, NULL, mythread, "B");

    pthread_join(p1, NULL);
    pthread_join(p2, NULL);
    printf("main: end\n");
    return 0;
    }
```

### ğŸ”¹ ì„¤ëª…:

- `mythread` í•¨ìˆ˜ëŠ” ì¸ìë¡œ ë°›ì€ ë¬¸ìì—´ì„ ì¶œë ¥
- `main` í•¨ìˆ˜ì—ì„œ ë‘ ê°œì˜ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ì¢…ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸° (`join`)
- ì‹¤í–‰ ê²°ê³¼ëŠ” A, Bì˜ ì¶œë ¥ ìˆœì„œê°€ **ë¹„ê²°ì •ì ** (ìŠ¤ì¼€ì¤„ëŸ¬ì— ë”°ë¼ ë‹¬ë¼ì§)

![[Pasted image 20250515114931.png]]


## ğŸ“˜ Example â€“ Passing Argument to Thread

```c
#include <stdio.h>
#include <pthread.h>

int sum = 0;

void *thread_summation(void *arg) {
    int start = ((int*)arg)[0];
    int end = ((int*)arg)[1];
    while (start <= end) {
        sum += start;
        start++;
    }
    return NULL;
}

int main() {
    pthread_t id_t1, id_t2;
    int range1[] = {1, 5};
    int range2[] = {6, 10};

    pthread_create(&id_t1, NULL, thread_summation, (void *)range1);
    pthread_create(&id_t2, NULL, thread_summation, (void *)range2);

    pthread_join(id_t1, NULL);
    pthread_join(id_t2, NULL);

    printf("result: %d\n", sum);
    return 0;
} 
```
ğŸ”¹ í•µì‹¬:
ë°°ì—´ì„ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ë²”ìœ„ ì„¤ì •
ì „ì—­ ë³€ìˆ˜ sumì— ëˆ„ì  í•© ì €ì¥
ê²°ê³¼: 1 + 2 + ... + 10 = 55


## ğŸ“˜ Example â€“ Return Value from Thread

```c
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

typedef struct {
    int a;
    int b;
} myarg_t;

typedef struct {
    int x;
    int y;
} myret_t;

void *mythread(void *arg) {
    myarg_t *m = (myarg_t *) arg;
    printf("%d %d\n", m->a, m->b);

    myret_t *r = malloc(sizeof(myret_t));
    r->x = 1;
    r->y = 2;
    return (void *) r;
}

int main() {
    pthread_t p;
    myret_t *m;
    myarg_t args = {10, 20};

    pthread_create(&p, NULL, mythread, &args);
    pthread_join(p, (void **) &m);
    printf("returned %d %d\n", m->x, m->y);
    return 0;
}
```
ğŸ”¹ í•µì‹¬:
êµ¬ì¡°ì²´ ì¸ìë¥¼ ì „ë‹¬í•˜ê³ , ë™ì  í• ë‹¹ëœ êµ¬ì¡°ì²´ë¥¼ ë¦¬í„´ ë°›ì•„ ì‚¬ìš©
ê²°ê³¼: 10, 20 
	returned 
ì£¼ì˜: malloc ì—†ì´ ìŠ¤íƒ ë³€ìˆ˜ ë°˜í™˜ ì‹œ ìœ„í—˜ (ë‹¤ìŒ ìŠ¬ë¼ì´ë“œì—ì„œ ì„¤ëª…)


## ğŸ“˜ Dangerous Code

- ìŠ¤ë ˆë“œì—ì„œ **ë°˜í™˜ê°’ìœ¼ë¡œ ì§€ì—­ ë³€ìˆ˜(ìŠ¤íƒ ë©”ëª¨ë¦¬)**ë¥¼ ë¦¬í„´í•˜ë©´ ìœ„í—˜

```c
void *mythread(void *arg) {
    myarg_t *m = (myarg_t *) arg;
    printf("%d %d\n", m->a, m->b);

    myret_t r;  // âŒ ìŠ¤íƒì— í• ë‹¹ëœ ë³€ìˆ˜
    r.x = 1;
    r.y = 2;
    return (void *) &r;  // â›” ìœ„í—˜: í•¨ìˆ˜ ì¢…ë£Œ ì‹œ ë©”ëª¨ë¦¬ í•´ì œë¨
}
```
### ğŸ”¹ í•´ê²°ì±…:

- ë°˜í™˜í•  ë°ì´í„°ëŠ” **í™(heap)** ì— `malloc`ìœ¼ë¡œ ë™ì  í• ë‹¹í•˜ì—¬ ë°˜í™˜í•´ì•¼ í•¨
